{"openapi":"3.1.0","info":{"title":"G-Engine API","description":"Добро пожаловать в G-Engine API 2.0 документацию!","version":"2.0"},"servers":[{"url":"/api/v2"}],"paths":{"/payment/verify":{"post":{"tags":["payments"],"summary":"Создание и верификация платежа.","description":"Создание и верификация платежа.","operationId":"verify_payment_payment_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPaymentCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/PaymentResponse"},{"type":"object"}],"title":"Response Verify Payment Payment Verify Post"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/payment/execute":{"post":{"tags":["payments"],"summary":"Выполнение платежа","description":"Выполнение платежа на основе transaction_id. Проверяет статус транзакции и инициирует оплату","operationId":"execute_payment_payment_execute_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecutePaymentParams"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseBase_Union_PaymentResponse__dict__"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/payment/status":{"get":{"tags":["payments"],"summary":"Статус платежа","description":"Получение статуса платежа","operationId":"view_payment_status_payment_status_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"query","required":true,"schema":{"type":"string","minLength":6,"maxLength":36,"description":"Идентификатор транзакции (UUID)","example":"b3f1c8d2-4e9a-42f5-bb8d-8e3b6c6c6a7f","title":"Transaction Id"},"description":"Идентификатор транзакции (UUID)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/PaymentResponse"},{"type":"object"}],"title":"Response View Payment Status Payment Status Get"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/token":{"post":{"tags":["auth"],"summary":"Получение токена","description":"Получение токена на основе логина и пароля","operationId":"login_auth_token_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAuth"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user":{"get":{"tags":["users"],"summary":"Пользователи","description":"Получение списка пользователей (только для Observer)","operationId":"view_users_user_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}},{"name":"sort_by","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sort By"}},{"name":"sort_order","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sort Order"}},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Start Date"}},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"End Date"}},{"name":"search_field","in":"query","required":false,"schema":{"anyOf":[{"type":"string","minLength":1,"maxLength":16},{"type":"null"}],"title":"Search Field"}},{"name":"search_value","in":"query","required":false,"schema":{"anyOf":[{"type":"string","minLength":1,"maxLength":36},{"type":"null"}],"title":"Search Value"}},{"name":"role_name","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/UserRole"},{"type":"null"}],"title":"Role Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserReadObserver"},"title":"Response View Users User Get"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user/balance":{"get":{"tags":["users"],"summary":"Баланс пользователя","description":"Получение баланса текущего пользователя","operationId":"view_user_balance_user_balance_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/UserBalance"},{"items":{"$ref":"#/components/schemas/UserBalanceObserver"},"type":"array"},{"type":"object"}],"title":"Response View User Balance User Balance Get"}}}},"404":{"description":"Not found"}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/me":{"get":{"tags":["users"],"summary":"Текущий пользователь","description":"Получение данных текущего пользователя","operationId":"view_user_me_user_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/UserMe"},{"type":"object"}],"title":"Response View User Me User Me Get"}}}},"404":{"description":"Not found"}},"security":[{"OAuth2PasswordBearer":[]}]}},"/transaction/view":{"get":{"tags":["transactions"],"summary":"Получение транзакций","description":"Получение списка транзакций","operationId":"view_transaction_transaction_view_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_cache","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"User Cache"}},{"name":"limit","in":"query","required":false,"schema":{"anyOf":[{"type":"integer","maximum":500,"minimum":1},{"type":"null"}],"default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":0,"title":"Offset"}},{"name":"sort_by","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"date","title":"Sort By"}},{"name":"sort_order","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"desc","title":"Sort Order"}},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Start Date"}},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"End Date"}},{"name":"search_field","in":"query","required":false,"schema":{"anyOf":[{"type":"string","minLength":3,"maxLength":16},{"type":"null"}],"title":"Search Field"}},{"name":"search_value","in":"query","required":false,"schema":{"anyOf":[{"type":"string","minLength":3,"maxLength":36},{"type":"null"}],"title":"Search Value"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"type":"array","items":{"$ref":"#/components/schemas/TransactionRead"}},{"type":"array","items":{"$ref":"#/components/schemas/TransactionReadObserver"}},{"type":"object"}],"title":"Response View Transaction Transaction View Get"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/currencies":{"get":{"tags":["currencies"],"summary":"Получение курсов валют","description":"Возвращение актуальных курсов валют","operationId":"view_currency_currencies_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"source","in":"query","required":true,"schema":{"$ref":"#/components/schemas/RateSource","description":"Источник курса валют"},"description":"Источник курса валют"},{"name":"pair","in":"query","required":true,"schema":{"$ref":"#/components/schemas/CurrencyPair","description":"Валютная пара"},"description":"Валютная пара"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseBase_Union_CurrencyRead__dict__"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"CurrencyPair":{"type":"string","enum":["USD:RUB","EUR:RUB"],"title":"CurrencyPair"},"CurrencyRead":{"properties":{"source":{"type":"string","title":"Source","description":"Источник курса"},"pair":{"type":"string","title":"Pair","description":"Валютная пара"},"currency_rate":{"type":"string","title":"Currency Rate","description":"Курс"}},"type":"object","required":["source","pair","currency_rate"],"title":"CurrencyRead"},"ExecutePaymentParams":{"properties":{"transaction_id":{"type":"string","maxLength":36,"minLength":6,"title":"Transaction Id","description":"Идентификатор транзакции (UUID)","example":"b3f1c8d2-4e9a-42f5-bb8d-8e3b6c6c6a7f"}},"type":"object","required":["transaction_id"],"title":"ExecutePaymentParams"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ParameterDTO":{"properties":{"name":{"type":"string","maxLength":20,"minLength":3,"title":"Name"},"param_number":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Param Number"},"external_param_number":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"External Param Number"},"id":{"type":"integer","title":"Id"}},"type":"object","required":["name","id"],"title":"ParameterDTO"},"PaymentResponse":{"properties":{"transaction_id":{"type":"string","maxLength":36,"title":"Transaction Id"},"amount_rub":{"type":"string","title":"Amount Rub"},"amount_usd":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Amount Usd"},"account":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Account"},"date":{"type":"string","format":"date-time","title":"Date"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"status_code":{"$ref":"#/components/schemas/StatusCode"},"issue_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Issue Date"}},"type":"object","required":["transaction_id","amount_rub","amount_usd","account","date","status_code"],"title":"PaymentResponse"},"RateSource":{"type":"string","enum":["cb_rf","steam"],"title":"RateSource"},"ResponseBase_Union_CurrencyRead__dict__":{"properties":{"success":{"type":"boolean","title":"Success","description":"Флаг успешности запроса"},"message":{"type":"string","title":"Message","description":"Сообщение с дополнительной информацией"},"data":{"anyOf":[{"$ref":"#/components/schemas/CurrencyRead"},{"type":"object"},{"type":"null"}],"title":"Data","description":"Данные ответа запроса"}},"type":"object","required":["success","message"],"title":"ResponseBase[Union[CurrencyRead, dict]]"},"ResponseBase_Union_PaymentResponse__dict__":{"properties":{"success":{"type":"boolean","title":"Success","description":"Флаг успешности запроса"},"message":{"type":"string","title":"Message","description":"Сообщение с дополнительной информацией"},"data":{"anyOf":[{"$ref":"#/components/schemas/PaymentResponse"},{"type":"object"},{"type":"null"}],"title":"Data","description":"Данные ответа запроса"}},"type":"object","required":["success","message"],"title":"ResponseBase[Union[PaymentResponse, dict]]"},"RoleRead":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"level":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Level"}},"type":"object","title":"RoleRead"},"ServiceDTO":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"anyOf":[{"type":"string","maxLength":30,"minLength":3},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":500,"minLength":20},{"type":"null"}],"title":"Description"},"service_number":{"type":"integer","title":"Service Number"},"image_path":{"anyOf":[{"type":"string","maxLength":255,"minLength":10},{"type":"null"}],"title":"Image Path"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","required":["id","service_number"],"title":"ServiceDTO"},"StatusCode":{"type":"string","enum":["DUPLICATE_TRANSACTION","INSUFFICIENT_FUNDS","PAYMENT_VERIFICATION_FAILED","PAYMENT_CONFIRMATION_FAILED","PAYMENT_SUCCESS","PAYMENT_IN_PROGRESS","PURCHASE_NOT_FOUND","REQUEST_ACCEPTED","CALCULATION_ERROR","TOP_UP_ERROR"],"title":"StatusCode"},"StoreDTO":{"properties":{"external_id":{"type":"integer","maximum":10000000000.0,"minimum":50.0,"title":"External Id"},"name":{"type":"string","maxLength":15,"minLength":3,"title":"Name"},"deduction":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Deduction","default":0.0},"system_store":{"anyOf":[{"$ref":"#/components/schemas/SystemStoreBase"},{"type":"null"}]},"id":{"type":"integer","title":"Id"}},"type":"object","required":["external_id","name","id"],"title":"StoreDTO"},"SystemStoreBase":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"color":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Color"}},"type":"object","title":"SystemStoreBase"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type"}},"type":"object","required":["access_token","token_type"],"title":"Token"},"TransactionRead":{"properties":{"transaction_id":{"type":"string","maxLength":36,"minLength":6,"title":"Transaction Id"},"date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Date"},"issue_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Issue Date"},"account":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Account"},"amount":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Amount"},"amount_usd":{"anyOf":[{"type":"number","maximum":10000.0,"minimum":0.0},{"type":"null"}],"title":"Amount Usd"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"status_code":{"anyOf":[{"$ref":"#/components/schemas/StatusCode"},{"type":"null"}]},"children":{"anyOf":[{"items":{"$ref":"#/components/schemas/TransactionRead"},"type":"array"},{"type":"null"}],"title":"Children"}},"type":"object","required":["transaction_id"],"title":"TransactionRead"},"TransactionReadObserver":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"code":{"type":"string","maxLength":36,"minLength":6,"title":"Code"},"code_api":{"anyOf":[{"type":"string","maxLength":15},{"type":"null"}],"title":"Code Api"},"parameter_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Parameter Id"},"store_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Store Id"},"date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Date"},"issue_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Issue Date"},"steam_login":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Steam Login"},"amount":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Amount"},"amount_usd":{"anyOf":[{"type":"number","maximum":10000.0,"minimum":0.0},{"type":"null"}],"title":"Amount Usd"},"cashback":{"anyOf":[{"type":"number","maximum":10000.0,"minimum":0.0},{"type":"null"}],"title":"Cashback"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"status_code":{"anyOf":[{"$ref":"#/components/schemas/StatusCode"},{"type":"null"}]},"gift_code":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Gift Code"},"parameter":{"anyOf":[{"$ref":"#/components/schemas/ParameterDTO"},{"type":"null"}]},"store":{"anyOf":[{"$ref":"#/components/schemas/StoreDTO"},{"type":"null"}]},"service":{"anyOf":[{"$ref":"#/components/schemas/ServiceDTO"},{"type":"null"}]},"children":{"anyOf":[{"items":{"$ref":"#/components/schemas/TransactionReadObserver"},"type":"array"},{"type":"null"}],"title":"Children"},"user":{"anyOf":[{"$ref":"#/components/schemas/UserReadTransactionObserver"},{"type":"null"}]}},"type":"object","required":["code"],"title":"TransactionReadObserver"},"UserAuth":{"properties":{"login":{"type":"string","title":"Login"},"password":{"type":"string","title":"Password"}},"type":"object","required":["login","password"],"title":"UserAuth"},"UserBalance":{"properties":{"currency":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currency","description":"Валюта баланса"},"balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Balance","description":"Текущий баланс пользователя в указанной валюте"},"cashback":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cashback","description":"Доступный кэшбэк пользователя в указанной валюте"}},"type":"object","required":["currency","balance","cashback"],"title":"UserBalance"},"UserBalanceObserver":{"properties":{"currency":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currency","description":"Валюта баланса"},"balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Balance","description":"Текущий баланс пользователя в указанной валюте"},"cashback":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cashback","description":"Доступный кэшбэк пользователя в указанной валюте"},"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"login":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Login"}},"type":"object","required":["currency","balance","cashback"],"title":"UserBalanceObserver"},"UserMe":{"properties":{"login":{"type":"string","maxLength":40,"minLength":3,"title":"Login"},"name":{"type":"string","maxLength":40,"minLength":3,"title":"Name"},"balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Balance"},"role":{"anyOf":[{"$ref":"#/components/schemas/UserRole"},{"type":"null"}]},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"},"is_beta":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Beta","default":false},"currency_version":{"anyOf":[{"type":"string","maxLength":3,"minLength":3},{"type":"null"}],"title":"Currency Version"}},"type":"object","required":["login","name"],"title":"UserMe"},"UserReadObserver":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"login":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Login"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name"},"role":{"anyOf":[{"$ref":"#/components/schemas/RoleRead"},{"type":"null"}]},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"},"balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Balance"},"cashback":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cashback"},"currency_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currency Version"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"UserReadObserver"},"UserReadTransactionObserver":{"properties":{"id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Id"},"login":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Login"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"},"balance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Balance"},"cashback":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cashback"},"currency_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currency Version"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"UserReadTransactionObserver"},"UserRole":{"type":"string","enum":["User","Support","Sales","Observer","Partner_Manager","Project_Manager","Administrator","Boss_Of_This_Gym"],"title":"UserRole"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VerifyPaymentCreate":{"properties":{"transaction_id":{"type":"string","maxLength":36,"minLength":6,"title":"Transaction Id","description":"Идентификатор транзакции (UUID)","example":"b3f1c8d2-4e9a-42f5-bb8d-8e3b6c6c6a7f"},"service_id":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Service Id","description":"Идентификатор сервиса"},"account":{"type":"string","maxLength":50,"minLength":4,"title":"Account","description":"Аккаунт для пополнения"},"amount":{"anyOf":[{"type":"number","exclusiveMinimum":0.0},{"type":"string"}],"title":"Amount","description":"Сумма транзакции"},"currency":{"type":"string","maxLength":3,"minLength":3,"title":"Currency","description":"Код валюты"}},"type":"object","required":["transaction_id","service_id","account","amount","currency"],"title":"VerifyPaymentCreate"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"auth/token"}}}}}}